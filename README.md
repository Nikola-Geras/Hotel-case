Прогнозирование оттока клиентов в сети отелей «Как в гостях»

Заказчик этого исследования — сеть отелей «Как в гостях». Чтобы привлечь клиентов, эта сеть отелей добавила на свой сайт возможность забронировать номер без предоплаты. Однако если клиент отменял бронирование, то компания терпела убытки. Сотрудники отеля могли, например, закупить продукты к приезду гостя или просто не успеть найти другого клиента. Чтобы решить эту проблему, вам нужно разработать систему, которая предсказывает отказ от брони. Если модель покажет, что бронь будет отменена, то клиенту предлагается внести депозит. Размер депозита — 80% от стоимости номера за одни сутки и затрат на разовую уборку. Деньги будут списаны со счёта клиента, если он всё же отменит бронь.

Итак, мы провели исследование, спрогнозировали отток клиентов, подведем итог:

Мы провели предобработку данных, удалили лишний столбец id, неинформативный в нашем деле, выявили дубликаты, которые решено было оставить, тк мы не знаем их истинную природу. Также исправили категориальные значения, в которых были ошибки и удалили единичные строки с нулевым количеством постояльцев.
В исследовательском анализе мы выявили дисбаланс целевого признака, отменяется 37-39 % брони. В дальнейшем при обучении модели данная проблема была решена. Выяснили, что столбец с непрерывными значениями lead_time имеет логнормальное распределение и выбросы. Имеет средний показатель 97,5. Этот признак больше всего коррелирует с целевым. В нем удалили выбросы, как и в столбце total_nights. Остальные признаки мы не трогали.
Узнали, что пик бронирований приходится на середину года, тогда как в начале и в конце возможны снижения из-за сезонности. Оживление может наблюдаться к Новому Году.
Далее подготовили данные для ML, очистили вышеозначенные столбцы от выбросов, разделили на признаки, в некоторых столбцах выявили категории более четко, провели масштабирование и кодирование через Binary Encoder нашей тренировочной выборки. Увеличили ее за счет увеличения положительного целевого признака. Но сделали это не для балансировки, но для увеличения тренировочной выборки, которая была очень мала по сравнению с тестовой.
Далее мы обучили наши модели. Выбрали три: лог регрессия, дерево решений, случайный лес. В качестве целевой метрики выбрали recall, тк нам было важно не отправить потенциальных отказников в список тех, кто точно не откажется от брони. Ведь именно в этом случае мы теряли деньги.
Из созданных моделей лучше всего была модель случайного леса с самым высоким показателем ROC_AUC и F1, но она нас не устраивала по показателю recall, который, как известно, был целевым. Поэтому мы будем использовать модель дерева решений, которая лишь слегка хуже, но у которой recall на тестовой выборке выдал 0,772. Это помогло бы нам увеличить прибыль на тестовой выборке до 11 млн руб. И это является достижением и позволяет окупить затраты в 400_000 руб на создание модели. Модель сохранили в файл decision_tree.pkl.
Оценивая портрет "ненадежного" заемщика пришли к выводу, что на ненадежность очень сильно влияет время ожидания между датой бронирования и заездом в отель. Конечно же, это связано с тем, что чем больше времени есть на раздумья, тем выше шанс отказа. В то же время долгие взаимоотношения с отелем, наличие уже осуществленных бронирований ранее, специальные отметки, предзаказанные места на парковке и тд. выявляют серьезные намерения у клиента. Конечно же, забронированные группами или юрлицами места реже подвергаются отменам. Как и номера категории E, D, F.
Особенно стоит обратить внимание на посетителей из Португалии. Они составляют значительную долю бронирований в отеле, но и частенько (около половины общего количества) их отменяют. Возможно, стоит отдельно выделить данную категорию гостей и понаблюдать. Если доля отмен будет увеличиваться, обложить их депозитом отдельно. Впрочем, модель и так достаточно хорошо предсказывает отмены.
